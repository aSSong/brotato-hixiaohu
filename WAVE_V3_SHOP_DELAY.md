# V3ç³»ç»Ÿ - å•†åº—å»¶è¿Ÿæ‰“å¼€

## éœ€æ±‚
æœ€åä¸€åªæ€ªæ€æ­»ä¹‹åï¼Œå»¶è¿Ÿ2ç§’å†æ‰“å¼€shopç•Œé¢ã€‚

## å®ç°

åœ¨ `wave_system_v3.gd` çš„ `_show_shop()` å‡½æ•°ä¸­æ·»åŠ å»¶è¿Ÿï¼š

```gdscript
func _show_shop() -> void:
    if current_state != WaveState.WAVE_COMPLETE:
        return
    
    # å»¶è¿Ÿ2ç§’å†æ‰“å¼€å•†åº—
    print("[WaveSystem V3] æ³¢æ¬¡å®Œæˆï¼Œ2ç§’åæ‰“å¼€å•†åº—...")
    await get_tree().create_timer(2.0).timeout
    
    _change_state(WaveState.SHOP_OPEN)
    print("[WaveSystem V3] ========== æ‰“å¼€å•†åº— ==========")
    
    # æš‚åœæ¸¸æˆ
    get_tree().paused = true
    
    # ... æ‰“å¼€å•†åº—é€»è¾‘ ...
```

## æ•ˆæœæµç¨‹

```
å‡»æ€æœ€åä¸€ä¸ªæ•Œäºº
    â†“
[WaveSystem V3] æ•Œäººç§»é™¤ | å‡»æ€ï¼š10 å‰©ä½™ï¼š0/10
    â†“
[WaveSystem V3] ========== ç¬¬ 1 æ³¢å®Œæˆï¼==========
    â†“
çŠ¶æ€: FIGHTING â†’ WAVE_COMPLETE
    â†“
[WaveSystem V3] æ³¢æ¬¡å®Œæˆï¼Œ2ç§’åæ‰“å¼€å•†åº—...
    â†“
ã€ç­‰å¾…2ç§’ã€‘
  - ç©å®¶å¯ä»¥ç»§ç»­ç§»åŠ¨
  - ç©å®¶å¯ä»¥æ‹¾å–æ‰è½ç‰©ï¼ˆé‡‘å¸ã€é’¥åŒ™ï¼‰
  - æ¸¸æˆæœªæš‚åœ
    â†“
2ç§’å
    â†“
çŠ¶æ€: WAVE_COMPLETE â†’ SHOP_OPEN
    â†“
[WaveSystem V3] ========== æ‰“å¼€å•†åº— ==========
    â†“
æš‚åœæ¸¸æˆ
    â†“
å•†åº—ç•Œé¢å¼¹å‡º
```

## ä¼˜åŠ¿

1. **ç¼“å†²æ—¶é—´**ï¼šç»™ç©å®¶2ç§’æ—¶é—´æ‹¾å–æ‰è½ç‰©
2. **ä½“éªŒä¼˜åŒ–**ï¼šä¸ä¼šçªç„¶å¼¹å‡ºå•†åº—æ‰“æ–­æ“ä½œ
3. **çŠ¶æ€æ¸…æ™°**ï¼šå»¶è¿ŸæœŸé—´ä»å¤„äº WAVE_COMPLETE çŠ¶æ€ï¼Œé˜²æ­¢å…¶ä»–æ“ä½œ

## æ—¥å¿—è¾“å‡º

```
[WaveSystem V3] æ•Œäººç§»é™¤ | å‡»æ€ï¼š10 å‰©ä½™ï¼š0/10
[WaveSystem V3] ========== ç¬¬ 1 æ³¢å®Œæˆï¼==========
[WaveSystem V3] å·²ç”Ÿæˆï¼š10 ç›®æ ‡ï¼š10
[WaveSystem V3] çŠ¶æ€å˜åŒ–ï¼šFIGHTING -> WAVE_COMPLETE
[WaveSystem V3] æ³¢æ¬¡å®Œæˆï¼Œ2ç§’åæ‰“å¼€å•†åº—...
[ç­‰å¾…2ç§’...]
[WaveSystem V3] ========== æ‰“å¼€å•†åº— ==========
[WaveSystem V3] çŠ¶æ€å˜åŒ–ï¼šWAVE_COMPLETE -> SHOP_OPEN
```

## å¯é…ç½®åŒ–ï¼ˆå¯é€‰ï¼‰

å¦‚æœå°†æ¥éœ€è¦è°ƒæ•´å»¶è¿Ÿæ—¶é—´ï¼Œå¯ä»¥æ·»åŠ é…ç½®å˜é‡ï¼š

```gdscript
@export var shop_delay: float = 2.0  # å•†åº—æ‰“å¼€å»¶è¿Ÿï¼ˆç§’ï¼‰

func _show_shop() -> void:
    # ...
    await get_tree().create_timer(shop_delay).timeout
    # ...
```

ç°åœ¨å‡»æ€æœ€åä¸€ä¸ªæ•Œäººåï¼Œä¼šç­‰å¾…2ç§’å†æ‰“å¼€å•†åº—ï¼Œç»™ç©å®¶æ—¶é—´æ‹¾å–ç‰©å“ï¼ğŸ®

